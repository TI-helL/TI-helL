# HTTP 에 대해 제대로 알아보자.

- [OSI 4계층 (혹은 7계층) 에 대해 알자.](#osi-4-------7-----------)
- [HTTP 란?](#http---)
  * [개요](#--)
  * [시스템 구성 요소](#---------)
- [HTTP 에 관련 된 의문들](#http-----------)
  * [1. **HTTP 는 TCP 를 사용하는 걸까?**](#1---http---tcp-------------)
  * [2. REST API 는 HTTP 를 사용하는 걸까?](#2-rest-api---http-----------)
  * [3. HTTP 는 Stateless 라는데, 비 연결형 전송과는 뭐가 다른 걸까?](#3-http---stateless--------------------------)


## OSI 4계층 (혹은 7계층) 에 대해 알자.

참고: [https://goitgo.tistory.com/25](https://goitgo.tistory.com/25)


둘다 네트워크 통신을 추상화한 계층이다.

OSI 4 계층은, 기존 컴퓨터와 시스템 네트워크 간의 계층 관계를 표현한 7계층을, 웹 통신 프로토콜 기준에 맞춰서 간소화 한 것이다.

크게 

1. 응용계층
2. 전송계층
3. 인터넷계층
4. 물리계층 

으로 나뉜다.

![91993635-95965980-ed70-11ea-84d9-477706041efe](https://user-images.githubusercontent.com/45758481/135411366-ea32dec8-8a01-4505-934a-da20ecab3ad1.png)


## HTTP 란?

### 개요

문서를 가져올 수 있도록 해주는 네트워크 프로토콜이다. 클라이언트-서버 프로토콜이기도 하다.

TCP 는 `패킷`을 다루지만, HTTP 는 `메시지`를 다룬다. 클라이언트가 보내는 메시지는 Request, 서버가 보내는 메시지는 Response 라고 부른다.

Http 는 OSI4 계층 중 응용 계층에 속한다.

---

### 시스템 구성 요소
![Client-server-chain](https://user-images.githubusercontent.com/45758481/135411488-3264eb0f-24a2-495c-ae3f-8decde79e545.png)

클라이언트와 서버가 HTTP 를 통해 메시지를 주고 받을 때, 사실 그 사이에는 여러 개체들이 존재한다.

예를 들면 `게이트웨이`나, 메시지들을 일시적으로 저장하는 캐시 역할을 하는 `프록시` 등이 있다.

> 프록시란?
웹 브라우저와 서버 사이에는 수많은 계층으로 이루어진 웹 스택 구조가 존재한다. </br>
성능에 영향을 크게 미치는 대부분의 요소들은 대부분 전송, 네트워크 계층에서 동작하고, HTTP 가 있는 최상위 응용 계층에서는 얘네가 어떻게 동작하는지 전혀 모른다. </br>
이런 요소 중에서도, 응용 계층에서 동작하는 것들을 일반적으로 `프록시` 라고 부른다. </br>
**캐시, 필터링, 로드밸런싱, 인증, 로깅 등이 모두 프록시가 수행 할 수 있는 기능들이다.** </br>


</br>

---

### 메시지 형식

기본적으로 시작줄, 헤더, 본문으로 구성 되어 있다.

1. 시작 줄

- 요청 메시지
```
메서드, 요청 URL, HTTP 버전
GET /document/item/1 1.1
```

- 응답 메시지
```
버전, 상태코드, 사유구절
1.1 200 OK
```

2. 헤더
메시지 본문에 대한 부가 정보.

- `Connection`: HTTP 연결을 위한 TCP 연결을 유지하기 위한 옵션을 설정 할 수 있다. `keep-alive`
- `Content-type`: 컨텐츠 유형. 
- `Cache-control`: HTTP로 문서가 캐싱되는 방식을 제어 할 수 있다. 캐싱 대상과 기간 등을 프록시와 클라이언트에 지시할 수도 있다.
- `CORS`: 나중에 따로 글 쓸거임.


</br> </br> </br>


## HTTP 에 관련 된 의문들

### 1. **HTTP 는 TCP 를 사용하는 걸까?**

HTTP 는 클라이언트와 서버를 연결하는 '전송' 프로토콜이 필요 없다. 전송 관련된 부분은 Transport 계층에서 다룬다.

HTTP 는 다만 두 가지의 전송 조건이 필요할 뿐이다.

1. 신뢰할 수 있을 것
2. 메시지의 손실이 없을 것

일반적인 전송 프로토콜 중에서 TCP 는 신뢰할 수 있고, UDP 는 그렇지 않다. 따라서 HTTP 는 TCP 의 전송 표준을 따르는 것 뿐이다.

HTTP 로 클라이언트와 서버가 메시지를 교환하려면, TCP 연결 설정이 필요하다.

`HTTP/1.0` 의 가장 기본적인 동작이 각 Req/Res 에 대해서 별도의 TCP 연결을 여는 것이고, 매 요청마다 TCP 연결을 먼저 요구하기 때문에 HTTP 요청이 자주 일어나는 경우 TCP 로 직접 패킷 스트림을 주고 받는 것보다 효율적이지 못한 것은 당연하다.

이를 해결하기 위해서 `HTTP/1.1` 에서는 '파이프라이닝' 과 '지속적 연결' 이라는 개념을 도입했는데, TCP 연결을 `Connection` 헤더 를 통해서 부분적으로 제어가 가능하다.

- `Keep-Alive` 라는 기능을 디폴트로 지원한다. 즉, 이미 연결 되어 있는 TCP 연결을 재사용 하게 해준다. 따라서 3-way handshake 과정을 생략하므로 성능이 대폭 향상 되었다.

---

### 2. REST API 는 HTTP 를 사용하는 걸까?

---

### 3. HTTP 는 Stateless 라는데, 비 연결형 전송과는 뭐가 다른 걸까?

**연결과 상태는 다르다!!!**
`Stateless` 는 상태가 없는 것을 말하고, `HTTP` 는 연결형 서비스이다. (TLS 를 사용하기 때문)

`Stateless` 는 서버가 클라이언트의 정보를 저장하지 않는 것이다. </br>
서버가 응답을 마치면연결을 끊어버린다.

따라서 서버는 요청마다 클라이언트가 누구인지 확인해야 하고, 따라서 HTTP 에서는 매 요청마다 헤더에 인증 토큰과 같은, 클라이언트가 본인임을 증명할 수 있는 매개체를 함께 보내게 된다.
이를 해소하기 위해서 `HTTP/2` 가 나오게 되었다.




---
